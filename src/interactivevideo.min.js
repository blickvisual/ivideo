function iVideo(i){this.options=i,this.container=$(i.container),this.video=null,this.events=[];var e=this;"object"==typeof i.json?(e.data=i.json,e.prepare(),$("#ivideo_loader").hide(),e.options.ready&&e.options.ready(e)):$.getJSON(i.json,function(i){e.data=i,e.prepare(),$("#ivideo_loader").hide(),e.options.ready&&e.options.ready(e)})}iVideo.prototype.on=function(i,e){this.events.push([i,e])},iVideo.prototype.hasProperty=function(i,e){return i.hasOwnProperty(e)&&i[e].length>0},iVideo.prototype.play=function(i){$("#ivideo_loader").show();var e=this.findChapterById(i);if(this.video.attr("loop",!1),this.clearOverlay(),this.hasProperty(e,"function")){self.video[0].pause();var o=!1;if($("#ivideo_loader").hide(),this.options.functions.forEach(function(i){if(i.name==e.function)return setTimeout(function(){i(e)},0),void(o=!0)}),!o)throw"Function "+e.function+" not found"}$("#ivideo_overlay").css("pointer-events","none"),this.hasProperty(e,"overlays")&&this.createOverlay(e),this.hasProperty(e,"src")&&(this.replaceVideo(e),this.playCurrentVideo(i))},iVideo.prototype.replaceVideo=function(i){$("video source",this.container).attr("src",i.src),this.video.data("id",i.id),"loop"==i.onfinished&&this.video.attr("loop",!0)},iVideo.prototype.playCurrentVideo=function(i){this.video[0].load(),this.video[0].play(),this.fadeIn(),this.findCallbackByName("play")&&this.findCallbackByName("play")(i)},iVideo.prototype.prepare=function(){self=this;var i=$('<div id="ivideo_loader"></div><div id="ivideo_fader" class="ivideo_full_frame" style="display:none"></div><div id="ivideo_overlay" class="ivideo_full_frame"></div><video width="100%" height="100%" playsinline>  <source src="" type="video/mp4"></video>');this.container.append(i),this.video=$("video",this.container);var e=this.options.fadercolor?this.options.fadercolor:"#000000";$("#ivideo_fader").css("background-color",e),this.video[0].onended=function(){self.fadeOut(function(){var i=self.findChapterById(self.video.data("id"));"goto"==i.onfinished&&self.play(i.goto)})},this.video[0].onplay=function(){$("#ivideo_loader").hide()},this.video.on("click",function(){self.video[0].paused?self.video[0].play():self.video[0].pause()})},iVideo.prototype.fadeOut=function(i){$("#ivideo_fader",this.container).fadeIn(200,i)},iVideo.prototype.fadeIn=function(i){$("#ivideo_fader",this.container).fadeOut(300,i)},iVideo.prototype.clearOverlay=function(){$("#ivideo_overlay").empty()},iVideo.prototype.createOverlay=function(i){this.clearOverlay(),$("#ivideo_overlay").css("pointer-events","inherit"),i.overlays.forEach(function(i){var e=$("<div class='ivideo_layer'>"),o=$("<div class='ivideo_hover ivideo_full_frame'></div>");o.css("background-image","url("+i.hover+")").css("background-repeat","no-repeat").css("background-size","cover"),e.append(o);var t=$("<div class='ivideo_linkbox'></div>");t.data("href",i.href),t.css("top",i.position[0]).css("left",i.position[1]),t.css("width",i.dimension[0]).css("height",i.dimension[1]),e.append(t),$("#ivideo_overlay",this.video).append(e)}),$(".ivideo_linkbox").off("click");var e=this;$(".ivideo_linkbox").on("click",function(i){e.fadeOut(function(){var o=$(i.target).data("href");o&&e.play(o)})}),$(".ivideo_linkbox").off("mouseenter"),$(".ivideo_linkbox").on("mouseenter",function(i){var e=$(".ivideo_hover",$(i.target).parent());e&&e.show()}),$(".ivideo_linkbox").off("mouseleave"),$(".ivideo_linkbox").on("mouseleave",function(i){var e=$(".ivideo_hover",$(i.target).parent());e&&e.hide()})},iVideo.prototype.findCallbackByName=function(i){var e=null;return this.events.forEach(function(o){o[0]==i&&(e=o[1])}),e},iVideo.prototype.findChapterById=function(i){var e=null;if(this.data.chapters.forEach(function(o){if(o.id==i)return void(e=o)}),!e)throw i+" not found";return e};